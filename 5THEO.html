<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>üè° 5 Th√©ophile Leducq - Marge √† la revente</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè°</text></svg>">

<style>
:root{
 --bg:#f5f5f7; --card:#ffffff; --text:#1d1d1f;
 --muted:#6e6e73; --line:#e5e5e7;
 --okbg:#f3fbf4; --lowbg:#fff5f5;
}
@media (prefers-color-scheme: dark){
 :root{
  --bg:#000; --card:#1c1c1e; --text:#f5f5f7;
  --muted:#a1a1a6; --line:#2c2c2e;
  --okbg:#0f2e16; --lowbg:#2a1414;
 }
}
body{margin:0;background:var(--bg);
font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Arial;
color:var(--text);}
.wrapper{max-width:980px;margin:40px auto;padding:12px;}
.card{background:var(--card);border-radius:18px;padding:28px;
box-shadow:0 8px 30px rgba(0,0,0,.08);}
h1{font-size:26px;margin-bottom:18px;}
.section-title{font-size:12px;text-transform:uppercase;
letter-spacing:.08em;color:var(--muted);margin:18px 0 8px;}
.acquisition{background:rgba(127,127,127,.08);
border-radius:12px;padding:16px;font-size:14px;line-height:1.6;}
.controls{display:grid;gap:10px;}
input[type=range]{width:100%;}
.range-value{font-size:22px;font-weight:600;text-align:right;}
.price-label{font-size:13px;color:var(--muted);margin-left:8px;}
.price-sub{font-size:13px;color:var(--muted);
text-align:right;line-height:1.5;}
.buttons{display:flex;gap:10px;margin:14px 0;}
button{border:1px solid var(--line);background:transparent;
padding:10px 14px;border-radius:999px;cursor:pointer;}
table{width:100%;border-collapse:collapse;font-size:14px;}
th{color:var(--muted);border-bottom:1px solid var(--line);padding:10px 6px;}
td{padding:12px 6px;border-bottom:1px solid var(--line);}
td.num{text-align:right;}
.row-ok{background:var(--okbg);}
.row-low{background:var(--lowbg);}
.pos{color:#34c759;font-weight:600;}
.neg{color:#ff453a;font-weight:600;}
.badge{padding:4px 10px;border-radius:999px;font-size:12px;
background:#34c75922;color:#34c759;}
@media print{
 body{background:white}
 .buttons,input,.section-title{display:none}
 .card{box-shadow:none}
}
</style>
</head>

<body>
<div class="wrapper">
<div class="card">

<h1>üè° 5 Th√©ophile Leducq ‚Äî Marge √† la revente</h1>

<div class="section-title">Donn√©es d‚Äôacquisition</div>
<div class="acquisition">
Prix d‚Äôachat : 341 964 ‚Ç¨<br>
Travaux : 77 268 ‚Ç¨<br>
Prix total : 419 233 ‚Ç¨<br>
Frais de notaire : 27 357 ‚Ç¨<br>
<strong>Co√ªt total : 446 590 ‚Ç¨</strong>
</div>

<div class="section-title">Prix net vendeur</div>

<div class="controls">
<input type="range" id="prixSlider" min="250000" max="600000" step="1000">

<div class="range-value">
<span id="prixValue"></span> ‚Ç¨
<span class="price-label">Prix net vendeur</span>
</div>

<div class="price-sub" id="priceSub"></div>
</div>

<div class="buttons">
<button onclick="window.print()">üñ®Ô∏è Imprimer</button>
<button onclick="window.print()">üìÑ Export PDF</button>
</div>

<div id="seuilNotaire"></div>
<div id="seuilTotal"></div>

<table>
<thead>
<tr>
<th>Mois</th>
<th class="num">Capital restant</th>
<th class="num">Marge brute</th>
<th class="num">Marge nette (‚àí notaire)</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

</div>
</div>

<script>
const FRAIS_NOTAIRE=27357;
const COUT_TOTAL=446590;
const TAUX_AGENCE=0.045;
const SURFACE=54;

/* dates + capitaux */
const data=[
["2026-02-05",353645.66],["2026-03-05",352290.24],
["2026-04-05",350933.07],["2026-05-05",349574.15],
["2026-06-05",348213.47],["2026-07-05",346851.04],
["2026-08-05",345486.84],["2026-09-05",344120.89],
["2026-10-05",342753.17],["2026-11-05",341383.69],
["2026-12-05",340012.43],["2027-01-05",338639.41],
["2027-02-05",337264.61],["2027-03-05",335888.03],
["2027-04-05",334509.67],["2027-05-05",333129.54],
["2027-06-05",331747.63],["2027-07-05",330363.93],
["2027-08-05",328978.44],["2027-09-05",327591.16],
["2027-10-05",326202.09],["2027-11-05",324811.23],
["2027-12-05",323418.57],["2028-01-05",322024.10],
["2028-02-05",320627.83],["2028-03-05",319229.76],
["2028-04-05",317829.89],["2028-05-05",316428.21],
["2028-06-05",315024.72],["2028-07-05",313619.42],
["2028-08-05",312212.30],["2028-09-05",310803.37],
["2028-10-05",309392.61],["2028-11-05",307980.04],
["2028-12-05",306565.64],["2029-01-05",305149.41],
["2029-02-05",303731.36],["2029-03-05",302311.47],
["2029-04-05",300889.75]
];

function formatMois(d){
 return d.toLocaleDateString("fr-FR",{month:"short",year:"2-digit"});
}

function filtre3Ans(d){
 const now=new Date();
 const end=new Date(); end.setMonth(end.getMonth()+36);
 return d.filter(([ds])=>{
  const dt=new Date(ds);
  return dt>=now && dt<=end;
 });
}

const slider=prixSlider;
const prixValue=document.getElementById("prixValue");
const priceSub=document.getElementById("priceSub");
const tbody=document.getElementById("tableBody");
const boxN=document.getElementById("seuilNotaire");
const boxT=document.getElementById("seuilTotal");

const start=new URLSearchParams(location.search).get("prix")||370000;
slider.value=start;

function render(v){
 const prix=+v;
 prixValue.textContent=prix.toLocaleString("fr-FR");

 const prixFAI=prix/(1-TAUX_AGENCE);
 const fraisAgence=prixFAI-prix;
 const prixM2=prixFAI/SURFACE;

 priceSub.innerHTML=`
 Prix FAI : ${prixFAI.toLocaleString("fr-FR",{maximumFractionDigits:0})} ‚Ç¨<br>
 Frais d‚Äôagence (4,5%) : ${fraisAgence.toLocaleString("fr-FR",{maximumFractionDigits:0})} ‚Ç¨<br>
 Prix au m¬≤ (FAI) : ${prixM2.toLocaleString("fr-FR",{maximumFractionDigits:0})} ‚Ç¨/m¬≤`;

 tbody.innerHTML="";
 let seuil=null;

 filtre3Ans(data).forEach(([ds,c])=>{
  const m=formatMois(new Date(ds));
  const brute=prix-c;
  const nette=brute-FRAIS_NOTAIRE;
  const ok=nette>=0;
  if(ok&&!seuil) seuil=m;

  tbody.innerHTML+=`
  <tr class="${ok?"row-ok":"row-low"}">
  <td>${m}</td>
  <td class="num">${c.toLocaleString("fr-FR",{minimumFractionDigits:2})}</td>
  <td class="num">${brute.toLocaleString("fr-FR",{minimumFractionDigits:2})}</td>
  <td class="num ${ok?"pos":"neg"}">
  ${nette.toLocaleString("fr-FR",{minimumFractionDigits:2})}
  </td></tr>`;
 });

 boxN.innerHTML=seuil?`Notaire couvert : <b>${seuil}</b>`:"";
 boxT.innerHTML=prix>=COUT_TOTAL?`Prix ‚â• co√ªt total <span class="badge">Profit complet</span>`:"";
}

slider.oninput=e=>render(e.target.value);
render(start);
</script>

</body>
</html>
